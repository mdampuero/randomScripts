(function($){$.fn.htmlWithJS=function(data){const target=$(this),replaceWith=!!arguments[1];return $.Deferred(function(mainDeffer){const content=$(data).not('script, style, [rel="stylesheet"], meta'),scripts=$(data).filter('script').toArray().reduce(function(result,script){const src=$(script).attr('src'),inline=$(script).html();if(src){result.src.push(src)}
if(inline){if(inline.search('function recaptchaOnloadCallback()')>-1){result.head.push(script)}else{result.inline.push(inline)}}
return result},{'src':[$.Deferred(function(deferred){$(deferred.resolve)})],'inline':[],'head':[]}),css=$(data).filter('style, [rel="stylesheet"]');if($(target).hasClass('widget-api')){$(target).trigger('deleted.pageWidget')}else{$(target).find('.widget-api').trigger('deleted.pageWidget')}
if(replaceWith){$(target).replaceWith(content.append(css,scripts.head))}else{$(target).html(content.append(css,scripts.head))}
$.ajaxSetup({cache:!0});scripts.src.reduce(function(l,src){return l.pipe(function(){return typeof src==='string'?$.Deferred(function(d){$.getScript(src).always(function(){$(d.resolve)})}):src})},$.Deferred().resolve()).done(function(){eval(scripts.inline.reduce(function(res,script){return res+';'+script},''));mainDeffer.resolveWith($(target))}).fail(function(){mainDeffer.rejectWith($(target))})})};$.fn.loadWithJS=function(src){const target=$(this);return $.Deferred(function(deferred){$.get(src,function(data){$(target).htmlWithJS(data).done(function(){deferred.resolveWith($(target))})}).fail(function(){deferred.rejectWith($(target))})})};$.fn.replaceWithJS=function(data){return $(this).htmlWithJS(data,!0)}})(jQuery)